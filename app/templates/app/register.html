{% extends "app/base.html" %}
{% load static %}
{% block css %}
<link
    href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
    rel="stylesheet"
/>
<link href="{% static 'css/index.css' %}" rel="stylesheet" />
{% endblock css %}

{% block content %}
<div class="flex justify-center items-center min-h-screen ">
    <div class="w-full max-w-3xl bg-white dark:bg-gray-800 shadow-lg rounded-lg p-10">
        <h2 class="text-4xl font-bold text-gray-900 dark:text-gray-100 text-center mb-8">Register</h2>
        <form method="post" class="space-y-6 flex gap- flex-col">
            {% csrf_token %}

                <div>
                    <label for="first_name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">First Name</label>
                    <input id="first_name" name="first_name" type="text" autocomplete="given-name" required
                        class="block w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-red-500 focus:border-red-500 sm:text-sm"
                        placeholder="First Name">
                </div>
                <div>
                    <label for="last_name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Last Name</label>
                    <input id="last_name" name="last_name" type="text" autocomplete="family-name" required
                        class="block w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-red-500 focus:border-red-500 sm:text-sm"
                        placeholder="Last Name">
                </div>
                <div>
                    <label for="email" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email Address</label>
                    <input id="email" name="email" type="email" autocomplete="email" required
                        class="block w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-red-500 focus:border-red-500 sm:text-sm"
                        placeholder="Email Address">
                </div>
                <div>
                    <label for="password1" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Password</label>
                    <input id="password1" name="password1" type="password" autocomplete="new-password" required
                        class="block w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-red-500 focus:border-red-500 sm:text-sm"
                        placeholder="Password">
                </div>
                <div>
                    <label for="password2" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Confirm Password</label>
                    <input id="password2" name="password2" type="password" autocomplete="new-password" required
                        class="block w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-red-500 focus:border-red-500 sm:text-sm"
                        placeholder="Confirm Password">
                </div>
                <div>
                    <label for="dob" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Date of Birth</label>
                    <input id="dob" name="dob" type="date" required
                        class="block w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-red-500 focus:border-red-500 sm:text-sm"
                        placeholder="Date of Birth">
                </div>
                <div>
                    <label for="gender" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Gender</label>
                    <select id="gender" name="gender" placeholder="Select Gender" required 
                        class="block w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-red-500 focus:border-red-500 sm:text-sm">
                        <option value="" disabled selected
                            class="text-gray-500 dark:text-gray-400">
                            Select Gender
                        </option>
                        <option value = "male" class="text-gray-900 dark:text-gray-400"> Male </option>
                        <option value = "female" class="text-gray-900 dark:text-gray-400"> Female </option>
                        <option value = "other" class="text-gray-900 dark:text-gray-400"> Rather not say </option>
                    </select> 
                    </div>   
                <div>
                    <label for="phone" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Phone</label>
                    <input id="phone" name="phone" type="tel" autocomplete="tel" required
                        class="block w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-red-500 focus:border-red-500 sm:text-sm"
                        placeholder="Phone">
                </div>
                <div>
                    <label for="address" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Address</label>
                    <input id="address" name="address" type="text" autocomplete="street-address" required
                        class="block w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-red-500 focus:border-red-500 sm:text-sm"
                        placeholder="Address">
                </div>
                <div>
                    <label for="city" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">City</label>
                    <input id="city" name="city" type="text" autocomplete="address-level2" required
                        class="block w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-red-500 focus:border-red-500 sm:text-sm"
                        placeholder="City">
                </div>
                <div>
                    <label for="state" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">State</label>
                    <input id="state" name="state" type="text" autocomplete="address-level1" required
                        class="block w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-red-500 focus:border-red-500 sm:text-sm"
                        placeholder="State">
                </div>
                <div>
                    <label for="zip_code" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Zip Code</label>
                    <input id="zip_code" name="zip_code" type="text" autocomplete="postal-code" required
                        class="block w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-red-500 focus:border-red-500 sm:text-sm"
                        placeholder="Zip Code">
                </div>
                <div>
                    <label for="any_previous_diseases" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Any Previous Diseases</label>
                    <textarea id="any_previous_diseases" name="any_previous_diseases" rows="3" autocomplete="off" required
                        class="block w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-red-500 focus:border-red-500 sm:text-sm"
                        placeholder="Any Previous Diseases"></textarea>
                </div>

            {% if error %}
            <div class="text-red-500 text-center text-sm mt-4">{{ error }}</div>
            {% endif %}
            <button type="submit" class="w-full py-3 px-4 bg-blue-600 text-white rounded-md shadow-md hover:bg-blue-700 transition duration-200">
                Register
            </button>
            <div class="text-center mt-6">
                <span class="text-gray-600 dark:text-gray-300 mb-1 text-sm">Already have an account?</span>
                <a href="{% url 'login' %}" class="text-blue-600 hover:text-blue-700 text-sm font-medium">Login</a>
            </div>
        </form>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    fetch('https://ipinfo.io/json') // Replace YOUR_API_TOKEN with your actual API token
        .then(response => response.json())
        .then(data => {
            const [city, region, zip] = data.region.split(','); // Customize this based on API response format
            document.getElementById('city').value = data.city || '';
            document.getElementById('state').value = data.region || '';
            document.getElementById('zip_code').value = data.postal || '';
        })
        .catch(error => console.error('Error fetching location data:', error));
});
</script>
{% endblock %}
